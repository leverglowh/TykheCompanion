(this["webpackJsonptykhe-companion"]=this["webpackJsonptykhe-companion"]||[]).push([[0],{42:function(e,t,n){},44:function(e,t,n){},49:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n.n(a),c=n(17),r=n.n(c),o=(n(42),n(43),n(19)),l=n(7),s=n(18),d=n(14),u=(n(44),/(^:[1-5]star128:\W*-\W*(.+)\W*-\W*[0-9]{4}$)|(^[1-5](s|star)?[\s-]{1}(.+)[\s-]{1}[0-9]{4}$)/),b=function(e,t){return e.name===t.name?e.tier>t.tier?-1:e.tier>t.tier?1:0:e.name<t.name?-1:1},j=n(9),v=n(37),p=n(22),O=n(36),f=n(1),h=function(){var e=Object(a.useState)(null),t=Object(d.a)(e,2),n=t[0],i=t[1],c=Object(a.useState)(""),r=Object(d.a)(c,2),h=r[0],m=r[1],g=Object(a.useState)(0),y=Object(d.a)(g,2),x=y[0],N=y[1],k=Object(a.useState)(""),S=Object(d.a)(k,2),w=S[0],E=S[1],I=Object(a.useState)(null),C=Object(d.a)(I,2),B=C[0],H=C[1],J=Object(a.useState)([]),R=Object(d.a)(J,2),D=R[0],q=R[1],T=Object(a.useState)(!1),A=Object(d.a)(T,2),M=A[0],F=A[1],L=Object(a.useState)(!1),K=Object(d.a)(L,2),P=K[0],U=K[1],X=Object(a.useCallback)((function(e){var t=localStorage.getItem("binId");if(t){var n=new XMLHttpRequest;n.onreadystatechange=function(){n.readyState===XMLHttpRequest.DONE&&console.log(JSON.parse(n.response).metadata?"Sync success":"Sync error")},n.open("PUT","https://api.jsonbin.io/v3/b/"+t,!0),n.setRequestHeader("Content-Type","application/json"),n.setRequestHeader("X-Master-Key","$2b$10$ckVgM1xPqSGsv8uaycGJNuOEQRN74Rq3HMCQLNpqmKFT37bAZprzC"),n.send(e?JSON.stringify(e):localStorage.getItem("inv"))}else{var a=new XMLHttpRequest;a.onreadystatechange=function(){a.readyState===XMLHttpRequest.DONE&&(localStorage.setItem("binId",JSON.parse(a.response).metadata.id),alert("Save this id so you can restore your inv in future: "+JSON.parse(a.response).metadata.id))},a.open("POST","https://api.jsonbin.io/v3/b",!0),a.setRequestHeader("Content-Type","application/json"),a.setRequestHeader("X-BIN-PRIVATE","false"),a.setRequestHeader("X-Master-Key","$2b$10$ckVgM1xPqSGsv8uaycGJNuOEQRN74Rq3HMCQLNpqmKFT37bAZprzC"),a.send(e?JSON.stringify(e):localStorage.getItem("inv"))}}),[]),$=Object(a.useCallback)((function(e){var t=new XMLHttpRequest;t.onreadystatechange=function(){if(t.readyState===XMLHttpRequest.DONE){var n=JSON.parse(t.response).record;if("object"!==typeof n)return alert("Invalid data, please check your backup id or upload an inv file."),document.getElementById("backup-id-input").value="",void localStorage.clear();if(!Object.keys(n).every((function(e){return Array.isArray(n[e])&&n[e].every((function(e){return W(e.tier,e.name,e.uid)}))})))return alert("Invalid data, please check your backup id or upload an inv file."),document.getElementById("backup-id-input").value="",void localStorage.clear();localStorage.setItem("inv",JSON.stringify(n)),localStorage.setItem("binId",e),window.location.reload()}},t.open("GET","https://api.jsonbin.io/v3/b/".concat(e,"/latest"),!0),t.send()}),[]);Object(a.useEffect)((function(){var e=localStorage.getItem("inv"),t=localStorage.getItem("binId");e?(i(JSON.parse(e)),X(JSON.parse(e))):t&&$(t)}),[X,$]),Object(a.useEffect)((function(){document.onkeyup=function(e){var t;"Escape"===e.key&&(m(""),E(""),null===(t=document.getElementById(x+""))||void 0===t||t.style.setProperty("text-decoration","none"),N(0))}}),[x]),Object(a.useEffect)((function(){n&&localStorage.setItem("inv",JSON.stringify(n))}),[n]);var W=function(e,t,n){var a=n+"";return!(!e||!t||!n||e>5||e<1||t.length<=0||a.includes(".")||a.includes(",")||4!==a.length||n<1e3)},G=function(e){E(e.target.value)},Q=function(e,t){var n;"Enter"===e.key&&(null===(n=document.getElementById(t))||void 0===n||n.click())},V=function(e){var t,n;e.persist();var a=null===(t=e.target)||void 0===t||null===(n=t.dataset)||void 0===n?void 0:n.cat;m(a),E("")},z=function(e){var t=0,n=0,a="";if(":"===(null===e||void 0===e?void 0:e[0])){if(!/^:[0-5]star128:/.test(e))return null;t=Number(e[1]);var i=Object(s.a)(e.split("-").map((function(e){return e.trim()}))).filter((function(e){return e.length>0}));n=Number(i[i.length-1]),a=i.slice(1,i.length-1).join(" - ")}else{var c;if(!/^[1-5][^0-9]+/.test(e))return null;var r=[];r=Object(s.a)(e.split("-").map((function(e){return e.trim()}))).filter((function(e){return e.length>0}));t=Number(null===(c=r[0].match(/\d+/g))||void 0===c?void 0:c[0])||0,n=Number(r[r.length-1]),a=r.slice(1,r.length-1).join(" - "),W(t,a,n)||(r=Object(s.a)(e.split(" ").map((function(e){return e.trim()}))).filter((function(e){return e.length>0})),t=Number(e[0]),n=Number(r[r.length-1]),a=r.slice(1,r.length-1).join(" "))}return W(t,a,n)?{tier:t,name:a,uid:n}:null},Z=function(e){var t,a=(w||"").replace(":lock:","").trim();if("JSON"===a)return null===(t=document.getElementById("downloadJSON"))||void 0===t||t.click(),m(""),N(0),E(""),void e.preventDefault();if("CLEAR"===a)return localStorage.clear(),void window.location.reload();if("CREATE CAT"===a)return U(!0),void e.preventDefault();if("DELETE CAT"===a)return H({cat:h,tier:0,name:"",uid:0}),void e.preventDefault();if(u.test(a)){var c=z(a);if(c){if(x){var r,d=n[h].find((function(e){return e.uid===x}));(null===c||void 0===c?void 0:c.name)!==(null===d||void 0===d?void 0:d.name)&&alert("Attention: you input a different card name, the old card will be replaced."),i(Object(l.a)(Object(l.a)({},n),{},Object(o.a)({},h,[].concat(Object(s.a)(n[h].filter((function(e){return e.uid!==x}))),[Object(l.a)({},c)]).sort(b)))),null===(r=document.getElementById(x+""))||void 0===r||r.style.removeProperty("text-decoration")}else Object.keys(n).forEach((function(e){if(!!n[e].find((function(e){return e.uid===(null===c||void 0===c?void 0:c.uid)})))throw alert("Duplicate UID, please check your data."),"Duplicate UID, please check your data."})),i(Object(l.a)(Object(l.a)({},n),{},Object(o.a)({},h,[].concat(Object(s.a)(n[h]),[Object(l.a)({},c)]).sort(b))));m(""),N(0),E(""),e.preventDefault()}else alert("Non valid input, abort! abort!")}else alert("Non valid input, abort! abort!")},Y=function(e){var t,a,i,c;if(e.persist(),"B"!==e.target.tagName){var r=null===(t=e.target)||void 0===t||null===(a=t.dataset)||void 0===a?void 0:a.cat,o=Number(null===(i=e.target)||void 0===i||null===(c=i.dataset)||void 0===c?void 0:c.uid);if(r&&o){var s=n[r].find((function(e){return e.uid===o}));H(Object(l.a)({cat:r},s))}}else e.target.parentElement.click()},_=function(e){var t,n,a,i,c;if(e.persist(),"B"!==e.target.tagName){var r=null===(t=e.target)||void 0===t||null===(n=t.dataset)||void 0===n?void 0:n.cat,o=Number(null===(a=e.target)||void 0===a||null===(i=a.dataset)||void 0===i?void 0:i.uid);if(r&&o){var l=document.getElementById(o+"");null===l||void 0===l||l.style.setProperty("text-decoration","line-through"),m(r),N(o),E((null===l||void 0===l||null===(c=l.firstElementChild)||void 0===c?void 0:c.innerHTML)||"")}}else e.target.parentElement.click()};return Object(f.jsxs)("div",{className:"main-container",children:[n?Object.keys(n).sort().map((function(e){return Object(f.jsxs)("div",{className:"cat",children:[Object(f.jsxs)("div",{className:"cat-header",children:[Object(f.jsx)("b",{children:e}),Object(f.jsx)("span",{className:"abs-right-button",title:"Add a new card","data-cat":e,onClick:V,children:"+"})]}),Object(f.jsxs)("div",{className:"cat-body",children:[h===e&&Object(f.jsxs)("div",{id:"new-card-form",children:[Object(f.jsxs)("div",{className:"card-format",children:["?",Object(f.jsxs)("span",{className:"card-format-info",children:["Copy from inv:",Object(f.jsx)("br",{}),Object(f.jsx)("b",{children:":2star128: - Hawkeye (Kate Bishop) - 2333"}),Object(f.jsx)("br",{}),"or manually insert",Object(f.jsx)("br",{}),Object(f.jsx)("b",{children:"2s Hawkeye (Kate Bishop) 2333"})]})]}),Object(f.jsx)("input",{id:"new-card-input-box",className:"new-card-input-box",type:"text",autoFocus:!0,value:w,onChange:G,onKeyUp:function(e){return Q(e,"new-card-input-submit-button")},placeholder:"2s Hawkeye (Kate Bishop) 2333"}),Object(f.jsx)("input",{type:"button",id:"new-card-input-submit-button",value:"\u2713",onClick:Z})]}),Object(f.jsx)("div",{className:"hide-overflow",children:n[e].map((function(t,i){var c,r;return Object(f.jsxs)(a.Fragment,{children:[(null===(c=n[e])||void 0===c||null===(r=c[i-1])||void 0===r?void 0:r.name)!==t.name&&Object(f.jsx)("hr",{}),Object(f.jsxs)("div",{className:"card-line star"+t.tier,id:t.uid+"",children:[Object(f.jsx)("span",{children:"".concat(t.tier,"s - ").concat(t.name," - ").concat(t.uid)}),Object(f.jsx)("span",{className:"edit-card-button unselectable","data-cat":e,"data-uid":t.uid,onClick:_,children:Object(f.jsx)("b",{children:"\u270e"})}),Object(f.jsx)("span",{className:"delete-card-button unselectable","data-cat":e,"data-uid":t.uid,onClick:Y,children:Object(f.jsx)("b",{children:"\xd7"})})]})]},t.uid)}))})]})]},e)})):Object(f.jsxs)("div",{className:"file-input-container",children:[Object(f.jsxs)("div",{children:[Object(f.jsx)("div",{className:"text-align-left",children:"Hi, please upload inventory text file."}),Object(f.jsx)("br",{}),Object(f.jsx)("input",{type:"file",name:"initial-inv-input",id:"initial-inv-input",accept:"text/plain",onChange:function(e){var t,n,a=null===e||void 0===e||null===(t=e.target)||void 0===t||null===(n=t.files)||void 0===n?void 0:n[0];if(console.log(a),a){var i=new FileReader;i.readAsText(a,"UTF-8"),i.onload=function(e){var t,n,a=null===e||void 0===e||null===(t=e.target)||void 0===t||null===(n=t.result)||void 0===n?void 0:n.replace(":lock:",""),i={},c="",r=a.split("\n"),o=0,d=[];r.forEach((function(e){if(e.startsWith(":")||/^[0-9]/.test(e)){var t=z(e.trim());if(!c||!t)return o++,void d.push(e);i[c].push(Object(l.a)({},t))}else if(e.length>1){var n=e.trim();n!==c&&(i[n]||(i[n]=[])),c=n}}));var u={};Object(s.a)(Object.keys(i)).forEach((function(e){if(0===i[e].length)return delete i[e],void d.push(e);u[e]=i[e].sort(b)})),localStorage.setItem("inv",JSON.stringify(u)),o>0?(q(d),F(!0)):window.location.reload()},i.onerror=function(e){alert("error")}}}})]}),Object(f.jsxs)("div",{children:[Object(f.jsx)("div",{className:"text-align-left",children:"Or input the backup id:"}),Object(f.jsxs)("div",{className:"backup-id-input-container",children:[Object(f.jsx)(O.a.Control,{placeholder:"607b400f0ed6f819beae5284",id:"backup-id-input",onKeyUp:function(e){return Q(e,"backup-id-input-button")}}),"\xa0",Object(f.jsx)(p.a,{id:"backup-id-input-button",onClick:function(e){var t,n=null===(t=document.getElementById("backup-id-input"))||void 0===t?void 0:t.value;n?$(n):alert("Invalid input, please check your backup id or upload an inv file.")},children:"Enter"})]})]})]}),Object(f.jsx)("a",{id:"downloadJSON",href:"data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(n)),download:"inv.json",style:{display:"none"},children:"DOWNLOAD JSON"}),B&&Object(f.jsxs)(j.a,{show:!0,backdrop:"static",keyboard:!1,children:[Object(f.jsx)(j.a.Header,{children:"Are you sure?"}),Object(f.jsx)(j.a.Body,{children:Object(f.jsxs)(v.a,{variant:"danger",children:["Are you sure you want to remove this?",Object(f.jsx)("br",{}),Object(f.jsx)("b",{children:B.tier?"".concat(B.tier,"s - ").concat(B.name," - ").concat(B.uid):"Category: ".concat(B.cat)})]})}),Object(f.jsxs)(j.a.Footer,{children:[Object(f.jsx)(p.a,{variant:"secondary",onClick:function(){H(null)},children:"Don't remove"}),Object(f.jsx)(p.a,{variant:"danger",onClick:function(){if(null===B||void 0===B?void 0:B.cat){if(!B.tier&&B.cat){var e=Object(l.a)({},n);return delete e[B.cat],i(e),void H(null)}B.uid&&(i(Object(l.a)(Object(l.a)({},n),{},Object(o.a)({},B.cat,Object(s.a)(n[B.cat].filter((function(e){return e.uid!==B.uid})))))),H(null))}},children:"Yes, do it."})]})]}),M&&D.length>0&&Object(f.jsxs)(j.a,{show:!0,backdrop:"static",keyboard:!1,children:[Object(f.jsx)(j.a.Header,{children:"Error encountered"}),Object(f.jsxs)(j.a.Body,{children:[Object(f.jsxs)(v.a,{variant:"danger",children:[D.length," error(s) encountered in these lines:"]}),Object(f.jsx)("div",{className:"import-error-log-container",children:D.map((function(e,t){return Object(f.jsxs)("div",{children:[Object(f.jsxs)("span",{className:"error-log-index unselectable",children:[t+1,"\xa0"]}),e]})}))})]}),Object(f.jsx)(j.a.Footer,{children:Object(f.jsx)(p.a,{variant:"secondary",onClick:function(){window.location.reload()},children:"OK"})})]}),P&&Object(f.jsxs)(j.a,{show:!0,children:[Object(f.jsx)(j.a.Header,{closeButton:!0,children:"New sub category"}),Object(f.jsx)(j.a.Body,{children:Object(f.jsx)(O.a.Control,{id:"new-subcat-input",placeholder:"Marvel Cinematic Universe",autoFocus:!0,onKeyUp:function(e){return Q(e,"new-subcat-input-button")}})}),Object(f.jsx)(j.a.Footer,{children:Object(f.jsx)(p.a,{variant:"primary",id:"new-subcat-input-button",onClick:function(){var e=document.getElementById("new-subcat-input").value;e?(i(Object(l.a)(Object(l.a)({},n),{},Object(o.a)({},e,[]))),U(!1),m(""),N(0),E("")):alert("Invalid category name")},children:"ADD"})})]})]})},m=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,51)).then((function(t){var n=t.getCLS,a=t.getFID,i=t.getFCP,c=t.getLCP,r=t.getTTFB;n(e),a(e),i(e),c(e),r(e)}))};r.a.render(Object(f.jsx)(i.a.StrictMode,{children:Object(f.jsx)(h,{})}),document.getElementById("root")),m()}},[[49,1,2]]]);
//# sourceMappingURL=main.e81d8539.chunk.js.map